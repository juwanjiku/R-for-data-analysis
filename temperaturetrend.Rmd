# Load required libraries
library(tidyverse)   # Data manipulation and visualization
library(lubridate)   # Date handling
library(zoo)        # Moving averages
library(forecast)   # Time series forecasting
library(tseries)    # Stationarity tests

# Load the dataset
temp_data <- read.csv("C:/Users/Admin/Downloads/kenya-climate-data-1991-2016-temp-degress-celcius.csv")

# Check for missing values
sum(is.na(temp_data))  # If any, use na.omit() or imputation

summary(temp_data)

hist(temp_data$Temperature....Celsius.,
     main = "Histogram of Monthly Average Temperatures (1991–2016)",
     xlab = "Temperature (°C)",
     col = "lightblue",
     border = "black")
     
temp_data$Year <- as.numeric(as.character(temp_data$Year))
# Fit the linear model
model <- lm(Temperature....Celsius. ~ Year, data = temp_data)

# View summary of the regression
summary(model)
ggplot(temp_data, aes(x = Year, y = Temperature....Celsius.)) +
  geom_point(color = "darkblue") +
  geom_smooth(method = "lm", se = TRUE, color = "red") +
  labs(title = "Linear Regression: Temperature vs Year",
       x = "Year",
       y = "Temperature (°C)") +
  theme_minimal()
  temp_data$Year <- as.numeric(as.character(temp_data$Year))
# Fit the linear model
model <- lm(Temperature....Celsius. ~ Year, data = temp_data)

# View summary of the regression
summary(model)

library(tidyverse)
library(zoo)  # For rolling means

# 12-month moving average
temp_data$MA12 <- rollmean(temp_data$Temperature....Celsius., k = 12, fill = NA, align = "right")

ggplot(temp_data, aes(x = 1:nrow(temp_data))) +
  geom_line(aes(y = Temperature....Celsius.), color = "gray60", size = 1, alpha = 0.6) +
  geom_line(aes(y = MA12), color = "blue", size = 1.2) +
  labs(title = "Monthly Average Temperature with 12-Month Moving Average",
       x = "Time (Index)",
       y = "Temperature (°C)") +
  theme_minimal()
library(tidyverse)
library(lubridate)
library(forecast)
library(tseries)
  # Combine Year and Month into a date
temp_data$Date <- as.Date(paste(temp_data$Year, temp_data$Month, "01", sep = "-"), format = "%Y-%b-%d")

# Sort 
library(dplyr)
library(forecast)
temp_data <- temp_data %>% arrange(Date)

ts_temp <- ts(temp_data$Temperature....Celsius., start = c(1991, 1), frequency = 12)

#test for stationarity
adf.test(ts_temp)

#fitting ARIMA model
model <- auto.arima(ts_temp)
summary(model)

#forecast
forecast_temp <- forecast(model, h = 24)

# Plot the forecast
autoplot(forecast_temp) +
  ggtitle("ARIMA Forecast of Temperature (Next 2 Years)") +
  ylab("Temperature (°C)") +
  xlab("Year")
  
  #checking residuals
checkresiduals(model)

# Create a time index column first
temp_data$Time <- 1:nrow(temp_data)

# Fit a linear trend model
trend_model <- lm(Temperature....Celsius. ~ Time, data = temp_data)

# Extract the slope (coefficient for Time)
monthly_change <- coef(trend_model)["Time"]
yearly_change <- monthly_change * 12
decade_change <- yearly_change * 10

# Print results
cat("Monthly change: ", round(monthly_change, 4), "°C\n")
cat("Yearly change: ", round(yearly_change, 4), "°C\n")
cat("Decade change: ", round(decade_change, 4), "°C\n")